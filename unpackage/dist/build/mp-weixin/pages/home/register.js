(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/home/register"],{"46d9":function(e,t,n){},"553a":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return i}));var i={uNavbar:function(){return n.e("uview-ui/components/u-navbar/u-navbar").then(n.bind(null,"2122"))},uForm:function(){return n.e("uview-ui/components/u-form/u-form").then(n.bind(null,"ab69"))},uFormItem:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-form-item/u-form-item")]).then(n.bind(null,"b773"))},uInput:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-input/u-input")]).then(n.bind(null,"7fd0"))},uUpload:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-upload/u-upload")]).then(n.bind(null,"5045"))},uTag:function(){return n.e("uview-ui/components/u-tag/u-tag").then(n.bind(null,"8281"))},uGap:function(){return n.e("uview-ui/components/u-gap/u-gap").then(n.bind(null,"ffb8"))},uButton:function(){return n.e("uview-ui/components/u-button/u-button").then(n.bind(null,"5352"))},uPickerNation:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-picker-nation/u-picker-nation")]).then(n.bind(null,"613e"))},uActionSheet:function(){return n.e("uview-ui/components/u-action-sheet/u-action-sheet").then(n.bind(null,"f997"))},uSelect:function(){return n.e("uview-ui/components/u-select/u-select").then(n.bind(null,"1093"))},uSelectSliderRange:function(){return n.e("uview-ui/components/u-select-slider-range/u-select-slider-range").then(n.bind(null,"4f11"))},uPopup:function(){return n.e("uview-ui/components/u-popup/u-popup").then(n.bind(null,"5c2c"))},uParse:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-parse/u-parse")]).then(n.bind(null,"c60b"))}},o=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.sexAcitonSheetShow=!0},e.e1=function(t){e.provinceSelectShow=!0},e.e2=function(t){e.tongxinAcitonSheetShow=!0},e.e3=function(t){e.sexMatchAcitonSheetShow=!0},e.e4=function(t){e.matchAge.selectShow=!0},e.e5=function(t){e.tongxinMatchAcitonSheetShow=!0})},s=[]},"5f14":function(e,t,n){"use strict";var i=n("46d9"),o=n.n(i);o.a},9614:function(e,t,n){"use strict";(function(e){n("66ba");i(n("66fd"));var t=i(n("bfb0"));function i(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n("543d")["createPage"])},bfb0:function(e,t,n){"use strict";n.r(t);var i=n("553a"),o=n("d5a3");for(var s in o)"default"!==s&&function(e){n.d(t,e,(function(){return o[e]}))}(s);n("5f14");var r,a=n("f0c5"),u=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,"264fd166",null,!1,i["a"],r);t["default"]=u.exports},bfe4:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=c(n("a34a")),o=c(n("ac3a")),s=c(n("3ea0")),r=c(n("03e9")),a=n("feab"),u=n("26cb");function c(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n,i,o,s,r){try{var a=e[s](r),u=a.value}catch(c){return void n(c)}a.done?t(u):Promise.resolve(u).then(i,o)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var s=e.apply(t,n);function r(e){l(s,i,o,r,a,"next",e)}function a(e){l(s,i,o,r,a,"throw",e)}r(void 0)}))}}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=function(){n.e("compoents/home/home-data").then(function(){return resolve(n("5167"))}.bind(null,n)).catch(n.oe)},g={name:"HomeRegister",components:{homeData:p},computed:m(m({},(0,u.mapState)({isLogin:"isLogin",userid:"userid",userInfo:"userInfo"})),{},{nationState:{get:function(){return this.model.nationTag+"-"+this.model.provinceTag},set:function(){}},ageRegionComp:{get:function(){return 0===this.model.startAge&&60===this.model.endAge?"不限":this.model.startAge+"岁 ~ "+this.model.endAge+"岁"},set:function(){}}}),data:function(){return{interests:[],areaCode:["1","11"],defaultValue:[0,60],titleWords:0,introduceWords:0,tagCount:0,height:300,registerHeadImage:"../../static/treehole/register-head.png",srcleft:"../../../static/treehole/my/back.png",txUrl:"../../static/treehole/biu/touxiang.png",txCamare:"../../static/treehole/zhuce-xiangji.png",mapImg:"../../static/treehole/zhuce-dingwei.png",imgsize:46,currIdx:0,btnRightTitles:["下一步","下一步","下一步","下一步","提交"],matchAge:{value:"",selectShow:!1},model:{sex:"0",birthdayYear:"",nation:"",nationTag:"",province:"",provinceTag:"",communicates:"",username:"",phone:"",district:"",city:"",country:"",address:"",street:"",email:"",title:"",introduce:"",images:"",interests:{list:[]},searchSexes:3,searchSexesTag:"不限",searchCommunicates:3,searchCommunicatesTag:"不限",startAge:0,endAge:60},pickerShow:!1,maxlength:10,inputAlign:"right",rules:{sexTag:[{required:!0,message:"请选择性别",trigger:"change"}],communicatesTag:[{required:!0,message:"请选择通讯方式",trigger:"change"}],title:[{required:!0,message:"请输入标题",trigger:"blur"}],introduce:[{required:!0,message:"请输入内容",trigger:"blur"}]},yearActionSheetShow:!1,yearList:[],tongxinList:[{text:"邮寄信件"},{text:"E-mail"},{text:"不限"}],sexList:[{text:"男"},{text:"女"},{text:"保密"}],sexMatchList:[{text:"男"},{text:"女"},{text:"不限"}],provinceSelectShow:!1,provinceList:o.default,labelWidth:200,sexAcitonSheetShow:!1,tongxinAcitonSheetShow:!1,tongxinMatchAcitonSheetShow:!1,sexMatchAcitonSheetShow:!1,labelPosition:"left",labelPosition_top:"top",errorType:["toast"],btnLeftStyle:{border:"1rpx solid #AE9F82","background-color":"#FFFFFF",color:"#AE9F82 !important",width:"200rpx"},btnRightStyle:{border:"1rpx solid #AE9F82","background-color":"#AE9F82",color:"#FFFFFF !important",width:"200rpx"},customStyleTitle:{"font-size":"36rpx",color:"#363D50"},colorList:["#394052","#FFFFFF"],bgColorList:["#F5F5F5","#AE9F82"],fileList:[],fileTemp:"",fileUrl:"",limitType:["png","jpg","jpeg","webp","gif","image"],header:{token:e.getStorageSync("token")},action:s.default.apiUrl+"/upload",check:!1,agreement:!1,showpopup:!1,content:""}},onReady:function(){this.$refs.uForm.setRules(this.rules)},onLoad:function(){var e=this;this.model.sexTag=this.sexList[0===this.userInfo.sex?2:this.userInfo.sex-1].text,this.model.searchSexes=this.userInfo.searchSexes.value,this.model.searchSexesTag=this.userInfo.searchSexes.tag,this.userInfo.images.length>0&&this.userInfo.images.map((function(t){var n={url:t};e.fileList.push(n)})),this.userInfo.interests.list.length>0&&this.userInfo.interests.list.map((function(t){1===t.checked&&e.tagCount++})),this.model=m(m({},this.model),{},{sex:this.userInfo.sex,birthdayYear:this.userInfo.birthdayYear,nation:this.userInfo.nation.code,nationTag:this.userInfo.nation.name,province:this.userInfo.province.code,provinceTag:this.userInfo.province.name,communicates:this.userInfo.communicates.value,communicatesTag:this.userInfo.communicates.tag,username:this.userInfo.username,phone:this.userInfo.phone,address:this.userInfo.address,street:this.userInfo.street,email:this.userInfo.email,zipcode:this.userInfo.zipcode,title:this.userInfo.title,introduce:this.userInfo.introduce,images:this.userInfo.images,interests:this.userInfo.interests,searchCommunicates:this.userInfo.searchCommunicates.value,searchCommunicatesTag:this.userInfo.searchCommunicates.tag,startAge:this.userInfo.startAge,endAge:this.userInfo.endAge}),this.areaCode=[this.model.nation?this.model.nation:"1",this.model.province?this.model.province:"11",""]},created:function(){this.initSelectList()},methods:{toMap:function(){var t=this;e.chooseLocation({success:function(e){console.log("位置名称："+e.name),console.log("详细地址："+e.address),t.model.address=e.address,t.model.street=e.name}})},titleInput:function(e){this.titleWords=e.length},introduceInput:function(e){this.introduceWords=e.length},initSelectList:function(){var t=new Date,n=Number(t.getFullYear())-1;this.yearList=[];for(var i=n;i>1950;i--){var o={label:i.toString(),value:i.toString()};this.yearList.push(o)}var s=this;s.$http.post("/my/info").then((function(t){501===t.data.code&&setTimeout((function(){e.hideLoading(),s.$store.dispatch("Logout")}),800),s.interests=t.data.data.interests.list,s.model.interests.list=t.data.data.interests.list})).catch((function(e){var t=e.message;s.$tip.error(t)})).finally((function(){}))},matchAgeConfirm:function(e){this.matchAge.value=e[0]+","+e[1],this.model.startAge=e[0],this.model.endAge=e[1],this.defaultValue=e},cancelAgeConfirm:function(){var e=[0,60];this.matchAge.value=e[0]+","+e[1],this.model.startAge=e[0],this.model.endAge=e[1],this.defaultValue=e},sexAcitonSheetCallback:function(t){e.hideKeyboard(),this.model.sexTag=this.sexList[t].text,this.model.sex=2===t?0:t+1},editBirthdayYear:function(){this.yearActionSheetShow=!0},provinceAcitonSheetCallback:function(t){e.hideKeyboard(),this.model.province=this.provinceList[t].text},yearSelectConfirm:function(t){e.hideKeyboard(),this.model.birthdayYear=t[0].value},yearSelectCancel:function(){e.hideKeyboard(),this.model.birthdayYear=""},tongxinAcitonSheetCallback:function(t){e.hideKeyboard(),this.model.communicates=t+1,this.model.communicatesTag=this.tongxinList[t].text},tongxinMatchAcitonSheetCallback:function(t){e.hideKeyboard(),this.model.searchCommunicates=t+1,this.model.searchCommunicatesTag=this.tongxinList[t].text},sexMatchAcitonSheetCallback:function(t){e.hideKeyboard(),this.model.searchSexes=t+1,this.model.searchSexesTag=this.sexMatchList[t].text},preStep:function(){this.currIdx>0?this.currIdx--:this.$u.toast("已经是第一页了")},uploadSuccess:function(e,t,n,i){200===e.code&&(n[t].url=e.data.url,this.fileList=n,console.log("this.fileList::",this.fileList))},uploadRemove:function(e,t,n){this.fileList=t},customCheck:function(e){if(1===e&&(!this.model.username||!this.model.street||!this.model.address||!this.model.zipcode))return this.$u.toast("请完善邮寄信息！"),!1;if(2===e&&!this.model.email)return this.$u.toast("请填写E-mail地址！"),!1;if(3===e){if(!this.model.username||!this.model.street||!this.model.address||!this.model.zipcode)return this.$u.toast("请完善邮寄信息！"),!1;if(!this.model.email)return this.$u.toast("请填写E-mail地址！"),!1}return!0},submit:function(){var e=this;if(4===e.currIdx){if(!e.customCheck(e.model.communicates))return;e.$refs.uForm.validate((function(t){if(t){console.log("验证通过");var n=[];e.model.interests.list.filter((function(e){return 1===e.checked})).map((function(e){n.push(e.id)})),console.log("-----------:",n);var i=[];e.fileList.map((function(e){i.push(e.url)}));var o=["sex","birthday_year","nation","province","username","phone","city","country","address","street","zipcode","email","communicate","title","introduce","interest","images","interest","search_sex","search_communicate","match_start_age","match_end_age"],s=e.model;s.method=o.join(","),s.interests=n.join(","),s.images=i.join(","),console.info("register:::",s),e.updateApi(s)}else console.log("验证失败")}))}else{if(0===e.currIdx&&!e.model.communicates)return void e.$u.toast("请选择通信方式");if(1===e.currIdx){if(1===e.model.communicates||3===e.model.communicates){if(!e.model.username)return void e.$u.toast("请输入真实姓名");if(e.model.phone){if(!r.default.mobile(e.model.phone)&&!r.default.landline(e.model.phone))return e.$u.toast("输入手机号或者座机号"),!1}else;if(!e.model.street)return void e.$u.toast("请选择所在地区");if(!e.model.address)return void e.$u.toast("请输入详细地址");if(!e.model.zipcode)return void e.$u.toast("请输入邮政编码")}if(2===e.model.communicates||3===e.model.communicates){if(!e.model.email)return void e.$u.toast("请输入E-mail");if(!r.default.email(e.model.email))return e.$u.toast("E-mail格式错误！"),!1}}if(2===e.currIdx){if(!e.model.title)return void e.$u.toast("请输入寻友标题");if(!e.model.introduce)return void e.$u.toast("请输入寻友详情");if(e.titleWords>20)return void e.$u.toast("寻友标题不能超过20个字");if(e.introduceWords>200)return void e.$u.toast("寻友详情不能超过200个字")}if(3===e.currIdx&&0===e.tagCount)return void e.$u.toast("请选择兴趣爱好");e.currIdx++}},goBack:function(){e.navigateBack({})},handleClickXy:function(e){1===e?(this.content=a.AQ_CONTENT[2],this.showpopup=!0):2===e&&(this.content=a.AQ_CONTENT[1],this.showpopup=!0)},checkboxChange:function(e){this.agreement=e.value},yhxylook:function(){this.showpopup=!1},handleClick:function(e){if(0===this.model.interests.list[e].checked){if(10===this.tagCount)return void this.$u.toast("最多只能选择10个");this.tagCount++}else this.tagCount--;this.model.interests.list[e].checked=1===this.model.interests.list[e].checked?0:1},provinceSelectConfirm:function(e){this.model.nation={},this.model.province={},this.model.nation=e.province.value,this.model.nationTag=e.province.label,this.model.province=e.city.value,this.model.provinceTag=e.city.label,this.areaCode=[this.model.nation,this.model.province,""]},provinceSelectCancel:function(){this.model.nation={},this.model.nationTag="",this.model.province={},this.model.provinceTag="",this.model.district=""},updateApi:function(t){e.showLoading({mask:!0,title:"信息提交中..."});var n=this,i="/my/update/info";n.$http.post(i,t).then((function(t){e.hideLoading(),console.info(t),200===t.data.code?(n.$u.toast("提交成功"),e.reLaunch({url:"../index/index"})):501===t.data.code?setTimeout((function(){e.hideLoading(),n.$store.dispatch("Logout")}),800):(e.showToast({icon:"error",title:t.data.message,duration:3e3}),n.model.interests={list:n.interests})})).catch((function(e){var t=e.message;n.$tip.error(t)})).finally((function(){console.info(n.model)}))},selectFile:function(){var t=this,n=null;n=new Promise((function(t,n){e.chooseImage({count:1,sourceType:["album","camera"],sizeType:["original","compressed"],success:t,fail:n})})),n.then((function(e){e.tempFiles.map((function(e,n){t.checkFileExt(e)&&(t.fileTemp=e.path)})),t.uploadFile()})).catch((function(e){console.info("error::",e)}))},uploadFile:function(){var t=this;return d(i.default.mark((function n(){return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.fileTemp){n.next=2;break}return n.abrupt("return");case 2:e.uploadFile({url:t.action,filePath:t.fileTemp,name:"file",header:t.header,success:function(e){var n=t.$u.test.jsonString(e.data)?JSON.parse(e.data):e.data;[200,201,204].includes(e.statusCode)?(console.info("上传成功::",n),t.fileUrl=n.data.url,t.txUrl=n.data.url):(t.$u.toast("上传失败，请重试"),t.fileUrl="")},fail:function(e){t.$u.toast("上传失败，请重试"),t.fileUrl=""},complete:function(e){}});case 3:case"end":return n.stop()}}),n)})))()},checkFileExt:function(e){var t=!1,n="",i=/.+\./;return n=e.path.replace(i,"").toLowerCase(),t=this.limitType.some((function(e){return e.toLowerCase()===n})),t||this.$u.toast("不允许选择".concat(n,"格式的文件")),t}}};t.default=g}).call(this,n("543d")["default"])},d5a3:function(e,t,n){"use strict";n.r(t);var i=n("bfe4"),o=n.n(i);for(var s in i)"default"!==s&&function(e){n.d(t,e,(function(){return i[e]}))}(s);t["default"]=o.a}},[["9614","common/runtime","common/vendor"]]]);