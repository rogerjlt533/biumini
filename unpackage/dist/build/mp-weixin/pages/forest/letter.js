(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/forest/letter"],{"6a41":function(t,e,n){"use strict";n.r(e);var i=n("baae"),o=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=o.a},"81cd":function(t,e,n){"use strict";var i=n("f150"),o=n.n(i);o.a},"934f":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return i}));var i={uNavbar:function(){return n.e("uview-ui/components/u-navbar/u-navbar").then(n.bind(null,"2122"))},uParse:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-parse/u-parse")]).then(n.bind(null,"c60b"))},uGrid:function(){return n.e("uview-ui/components/u-grid/u-grid").then(n.bind(null,"16cb"))},uGridItem:function(){return n.e("uview-ui/components/u-grid-item/u-grid-item").then(n.bind(null,"7f6d"))},uImage:function(){return n.e("uview-ui/components/u-image/u-image").then(n.bind(null,"4bb9"))},uDivider:function(){return n.e("uview-ui/components/u-divider/u-divider").then(n.bind(null,"eb1c"))},uMask:function(){return n.e("uview-ui/components/u-mask/u-mask").then(n.bind(null,"5d73"))},uButton:function(){return n.e("uview-ui/components/u-button/u-button").then(n.bind(null,"5352"))},uGap:function(){return n.e("uview-ui/components/u-gap/u-gap").then(n.bind(null,"ffb8"))},uPopup:function(){return n.e("uview-ui/components/u-popup/u-popup").then(n.bind(null,"5c2c"))},uInput:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-input/u-input")]).then(n.bind(null,"7fd0"))}},o=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){t.showMenu=!1})},a=[]},"9b55":function(t,e,n){"use strict";n.r(e);var i=n("934f"),o=n("6a41");for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);n("81cd");var s,u=n("f0c5"),r=Object(u["a"])(o["default"],i["b"],i["c"],!1,null,"ac84a836",null,!1,i["a"],s);e["default"]=r.exports},b439:function(t,e,n){"use strict";(function(t){n("66ba");i(n("66fd"));var e=i(n("9b55"));function i(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=n,t(e.default)}).call(this,n("543d")["createPage"])},baae:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n("26cb");function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var u={components:{},computed:a(a({},(0,i.mapState)({isLogin:"isLogin"})),{},{labelTag:function(){return this.letter.label_tag?"#"+this.letter.label_tag+"#":""}}),data:function(){return{disalbed:!1,showKey:!1,focus:!1,placeholder:"",content:"",srcleft:"../../../static/treehole/my/back.png",imgsize:46,customStyleGrid:{margin:"-16rpx 0"},letter:{},pinglunIcons:["../../../static/treehole/biu/pinglun-0.png","../../../static/treehole/biu/pinglun-1.png"],dianzanIcons:["../../../static/treehole/biu/dianzan-0.png","../../../static/treehole/biu/dianzan-1.png"],gif:"http://biuimage.juqihui.cn/baobao.gif",gifsrc:"",menuUrl:["../../../static/treehole/biu/sd-share.png","../../../static/treehole/my/wd-guanzhu.png","../../../static/treehole/biu/sd-jubao.png","../../../static/treehole/my/wd-bianji.png","../../../static/treehole/biu/biu-lahei.png"],customStyle:{"background-color":"rgba(0, 0, 0, 0.05)",border:"1px solid rgba(174, 159, 130, 0.2)","border-radius":"16rpx"},favorImgList:[],showMenu:!1,left:0,top:0,pointUrl:"../../static/treehole/biu/point.png",menuBtnStyle:{"padding-left":"10rpx",border:"none","font-size":"32rpx",color:"#AE9F82","background-color":"#F5F5F5"},commentList:[],lastid:"",replyId:"",replyIndex:-1,isReply:!1,pagesize:9999,model:{},gifCount:0,dianzanOver:!0,eventChannel:{}}},onLoad:function(e){var n=this,i=e.params||e.payload;try{var o=JSON.parse(decodeURIComponent(i))}catch(r){o=JSON.parse(i)}this.letter=o,this.favorImgList=o.favor_images,this.$nextTick((function(){"pinglun"===o.typ&&(n.showKey=!0,n.focus=!0)})),this.getCommentList({note:this.letter.id,mine:0,page:1,size:this.pagesize});var s=this,u="/user/home";s.$http.post(u,{id:s.letter.user}).then((function(e){var n=e.data;200===n.code?s.model=a(a({},n.data),{},{communicate:n.data.communicate.value}):501===n.code&&setTimeout((function(){t.hideLoading(),s.$store.dispatch("Logout")}),800)})).catch((function(t){t.message})).finally((function(){})),this.eventChannel=this.getOpenerEventChannel()},onShareAppMessage:function(t){return this.showMenu=!1,{title:"欢迎来到我的树洞",path:"/pages/user/biu"}},methods:{copy:function(e){var n=this;t.setClipboardData({data:e,success:function(){n.$u.toast("复制成功")}})},toBiuPage:function(){if(0!==this.letter.nick_show){var e=a(a({},this.model),{},{friend:this.model.id});t.navigateTo({url:"../user/biu?params="+encodeURIComponent(JSON.stringify(e))})}},fromCommentToBiuPage:function(e){if(console.log("eeeeeeeeee: "+JSON.stringify(e)),1!==e.is_nickname){var n={friend:e.send_userid};t.navigateTo({url:"../user/biu?params="+encodeURIComponent(JSON.stringify(n))})}},handleDianzan:function(){var t=this;this.dianzanOver?(this.dianzanOver=!1,this.gifCount++,0===this.letter.is_favor?(this.gifsrc=this.gif+"?"+(new Date).getTime(),this.dianzan()):(this.gifCount=0,this.dianzan()),setTimeout((function(){t.dianzanOver=!0}),3e3)):this.$u.toast("太快了,休息一下吧~")},dianzan:function(){if(this.isLogin){var e="/hole/note/favor",n={id:this.letter.id},i=this;i.$http.post(e,n).then((function(e){var n=e.data;console.info("_result::",n),200===e.data.code?(i.letter.favor_num=n.data.favor_num,i.letter.is_favor=1===i.letter.is_favor?0:1,i.favorImgList=n.data.images,i.eventChannel.emit("acceptDataFromOpenedPage",{data:i.letter})):501===n.code?setTimeout((function(){t.hideLoading(),i.$store.dispatch("Logout")}),800):i.$u.toast(e.data.message)})).catch((function(t){t.message;console.info("handleDianzan:",t)})).finally((function(){}))}else this.$u.toast("请您先登录")},getCommentList:function(e){var n=this;n.$http.post("/hole/note/comment/group",e).then((function(e){var i=e.data;200===i.code?n.commentList=i.data.list:501===i.code&&setTimeout((function(){t.hideLoading(),n.$store.dispatch("Logout")}),800)})).catch((function(t){var e=t.message;console.info("err::",t),n.$tip.error(e)})).finally((function(){}))},popupClose:function(){this.focus=!1},openPinglun:function(){var t=this;this.isLogin?0===this.letter.allow_comment?this.$u.toast("作者关闭了评论"):(this.isReply=!1,this.placeholder="写评论",this.showKey=!0,setTimeout((function(){t.focus=!0}),300)):this.$u.toast("请您先登录")},openReply:function(t,e){this.getSubList(t.comment_id,e)},getSubList:function(e,n){var i=this;t.showLoading({title:"加载中..."}),i.$http.post("/hole/note/comment/items",{comment_id:e}).then((function(e){var o=e.data;200===o.code?i.commentList[n].subList=o.data.list:501===o.code&&setTimeout((function(){t.hideLoading(),i.$store.dispatch("Logout")}),800)})).catch((function(t){var e=t.message;i.$tip.error(e)})).finally((function(){t.hideLoading()}))},handleReply:function(t){var e=this;this.isLogin?0===this.letter.allow_comment?this.$u.toast("作者关闭了评论"):(this.isReply=!0,this.replyId=t.comment_id,this.replyIndex=-1,this.placeholder="回复笔友"+t.title,this.showKey=!0,setTimeout((function(){e.focus=!0}),300)):this.$u.toast("请您先登录")},handleReplySub:function(t,e){var n=this;this.isLogin?0===this.letter.allow_comment?this.$u.toast("作者关闭了评论"):(this.isReply=!0,this.replyId=t.comment_id,this.replyIndex=e,this.placeholder="回复笔友"+t.title,this.showKey=!0,setTimeout((function(){n.focus=!0}),300)):this.$u.toast("请您先登录")},handleOperate:function(t){this.showMenu||(this.left=Math.ceil(t.detail.x)-60,this.top=Math.ceil(t.touches[0].clientY)+10),this.showMenu=!0},handleFenxiang:function(){this.showMenu=!1},handleGuanzhu:function(){this.showMenu=!1;var e="/user/collect",n={method:"collect",relate:this.letter.user},i=this;i.$http.post(e,n).then((function(e){200===e.data.code?i.letter.is_collect=1:501===e.data.code?setTimeout((function(){t.hideLoading(),i.$store.dispatch("Logout")}),800):i.$u.toast(e.data.message)})).catch((function(t){t.message})).finally((function(){}))},handleJubao:function(){this.showMenu=!1;var e={id:this.letter.user};t.navigateTo({url:"../../pages/user/userhelp?params="+encodeURIComponent(JSON.stringify(e))})},submit:function(){var e="/hole/note/comment",n={};n=this.isReply?{method:"comment",note:this.letter.id,comment:this.replyId,content:this.content}:{method:"note",note:this.letter.id,content:this.content};var i=this;i.disalbed=!0,i.$http.post(e,n).then((function(e){var n=e.data;200===n.code?(i.getCommentList({note:i.letter.id,mine:0,page:1,size:i.pagesize}),i.content="",i.letter.comment_num++,i.letter.is_commented=1,console.info("acceptDataFromOpenedPage1",i.letter.comment_num),i.eventChannel.emit("acceptDataFromOpenedPage1",{data:{comment_num:i.letter.comment_num,is_commented:i.letter.is_commented}}),-1===i.replyIndex||(i.getSubList(i.replyId,i.replyIndex),i.replyIndex=-1),i.showKey=!1):501===n.code?setTimeout((function(){t.hideLoading(),i.$store.dispatch("Logout")}),800):(console.log(n),t.showToast({icon:"error",title:n.message,duration:3e3}))})).catch((function(t){var e=t.message;i.$tip.error(e)})).finally((function(){i.disalbed=!1}))},handlePreImage:function(e){t.previewImage({current:e,urls:this.letter.images})},handleEdit:function(){this.showMenu=!1,t.navigateTo({url:"../../pages/forest/write?params="+encodeURIComponent(JSON.stringify(this.letter))})},handleDelete:function(){this.showMenu=!1;var e="/hole/note/remove",n={id:this.letter.id},i=this;i.$http.post(e,n).then((function(e){200===e.data.code?t.navigateBack({}):501===e.data.code?setTimeout((function(){t.hideLoading(),i.$store.dispatch("Logout")}),800):i.$u.toast(e.data.message)})).catch((function(t){t.message;console.info("handleDelete:",t)})).finally((function(){}))}}};e.default=u}).call(this,n("543d")["default"])},f150:function(t,e,n){}},[["b439","common/runtime","common/vendor"]]]);