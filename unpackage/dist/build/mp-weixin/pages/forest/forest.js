(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/forest/forest"],{"26ff":function(t,e,n){"use strict";var o=n("f4a0"),i=n.n(o);i.a},2928:function(t,e,n){"use strict";(function(t){n("66ba");o(n("66fd"));var e=o(n("2efe"));function o(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=n,t(e.default)}).call(this,n("543d")["createPage"])},"2efe":function(t,e,n){"use strict";n.r(e);var o=n("345d"),i=n("bb14");for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);n("26ff");var s,r=n("f0c5"),u=Object(r["a"])(i["default"],o["b"],o["c"],!1,null,"3a3107da",null,!1,o["a"],s);e["default"]=u.exports},"345d":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return o}));var o={uNavbar:function(){return n.e("uview-ui/components/u-navbar/u-navbar").then(n.bind(null,"2122"))},uSticky:function(){return n.e("uview-ui/components/u-sticky/u-sticky").then(n.bind(null,"8564"))},uImage:function(){return n.e("uview-ui/components/u-image/u-image").then(n.bind(null,"4bb9"))},uLoadmore:function(){return n.e("uview-ui/components/u-loadmore/u-loadmore").then(n.bind(null,"05ad"))},uBackTop:function(){return n.e("uview-ui/components/u-back-top/u-back-top").then(n.bind(null,"3872"))}},i=function(){var t=this,e=t.$createElement;t._self._c},a=[]},"73de":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n("26cb");function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var r=t.getSystemInfoSync(),u=function(){n.e("compoents/home/tree-hole").then(function(){return resolve(n("3c6b"))}.bind(null,n)).catch(n.oe)},c={components:{TreeHole:u},computed:a({},(0,o.mapState)({isLogin:"isLogin"})),data:function(){return{scrollTop:0,letter:{},srcleft:"../../../static/treehole/title-linjian.png",imgsize:46,currIdx:0,sticky:{enable:!0},height:44,statusBarHeight:r.statusBarHeight,plusImg:"../../static/treehole/linjian/plus-white.png",customStyle:{"margin-bottom":"10rpx"},titledata:[{name:"林间",show:!0,icon:"../../../static/bar-linjian-1.png",url:"linjian"},{name:"我的树洞",show:!1,icon:"../../../static/treehole/linjian/biu-shudong.png",url:"wdshudong"}],tempList:[],mineList:[],loadStatus1:"loadmore",loadStatus2:"loadmore",page1:1,ismore1:1,page2:1,ismore2:1,lastid1:"",lastid2:"",pageSize:10}},created:function(){var t={method:"index",friend:"",page:this.page1,size:this.pageSize,last:""};this.loadData(t)},watch:{currIdx:function(e){1===e?this.isLogin?this.reloadData():(this.$u.toast("未登录"),setTimeout((function(){t.switchTab({url:"../home/home"})}),500)):this.reloadData()}},methods:{link2page:function(e,n,o){var i=this;e=a(a({},e),{},{typ:o}),t.navigateTo({url:"../../pages/forest/letter?params="+encodeURIComponent(JSON.stringify(e)),events:{acceptDataFromOpenedPage:function(t){i.tempList[n].favor_num=t.data.favor_num,i.tempList[n].is_favor=1===i.tempList[n].is_favor?0:1},acceptDataFromOpenedPage1:function(t){i.tempList[n].comment_num=t.data.comment_num,i.tempList[n].is_commented=1}}})},link2page1:function(e,n,o){var i=this;e=a(a({},e),{},{typ:o}),console.log("link2page1--item: "+JSON.stringify(e)),t.navigateTo({url:"../../pages/forest/letter?params="+encodeURIComponent(JSON.stringify(e)),events:{acceptDataFromOpenedPage:function(t){i.mineList[n].favor_num=t.data.favor_num,i.mineList[n].is_favor=1===i.mineList[n].is_favor?0:1},acceptDataFromOpenedPage1:function(t){i.mineList[n].comment_num=t.data.comment_num,i.mineList[n].is_commented=1}}})},handleDianzan:function(e){if(this.isLogin){var n=e.is_favor,o="/hole/note/favor",i={id:e.id},a=this;a.$http.post(o,i).then((function(i){var s=i.data;console.info(o,s.data),200===i.data.code?(e.favor_num=s.data.favor_num,e.is_favor=1===n?0:1,e.favor_images=s.data.images):501===s.code?setTimeout((function(){t.hideLoading(),a.$store.dispatch("Logout")}),800):a.$u.toast(i.data.message)})).catch((function(t){t.message})).finally((function(){}))}else this.$u.toast("请您先登录")},loadData:function(e){t.showLoading({mask:!0,title:"正在加载"});var n=this,o="/hole/note/list";console.info("树洞界面begin",n.$u.date(Date.now(),"yyyy-mm-dd hh:MM:ss")),n.$http.post(o,e).then((function(e){console.info("树洞界面end",n.$u.date(Date.now(),"yyyy-mm-dd hh:MM:ss"));var o=e.data;200===o.code?0===n.currIdx?(1===n.page1?n.tempList=o.data.list:n.tempList=n.tempList.concat(o.data.list),n.ismore1=o.data.more,n.lastid1=o.data.last,1===n.ismore1?n.loadStatus1="loadmore":n.loadStatus1="nomore"):(1===n.page2?n.mineList=o.data.list:n.mineList=n.mineList.concat(o.data.list),n.ismore2=o.data.more,n.lastid2=o.data.last,1===n.ismore2?n.loadStatus2="loadmore":n.loadStatus2="nomore"):501===o.code?setTimeout((function(){t.hideLoading(),n.$store.dispatch("Logout")}),800):console.info("500::",o.message)})).catch((function(t){console.info("err::",t);t.message})).finally((function(){t.hideLoading()}))},clickevent:function(t){t===this.currIdx||(this.currIdx=t,this.titledata[0].show=!this.titledata[0].show,this.titledata[1].show=!this.titledata[1].show)},send2Treehole:function(){this.isLogin?t.navigateTo({url:"./write"}):(this.$u.toast("未登录"),setTimeout((function(){t.switchTab({url:"../home/home"})}),500))},fixed:function(){},unfixed:function(){},reloadData:function(){this.tempList=[],0===this.currIdx?this.page1=1:this.page2=1;var t={method:0===this.currIdx?"index":"mine",friend:"",page:0===this.currIdx?this.page1:this.page2,size:this.pageSize,last:""};this.loadData(t)},handleOperate:function(e,n,o){var i,a;switch(e){case"guanzhu":i="/user/collect",a={method:"collect",relate:n},this.apiMethod(i,a,"guanzhu",o);break;case"jubao":if(this.isLogin){var s={id:n};t.navigateTo({url:"../../pages/user/userhelp?params="+encodeURIComponent(JSON.stringify(s))})}else t.navigateTo({url:"../home/home"});break;case"lahei":this.isLogin?(i="/user/black",a={relate:n},this.apiMethod(i,a,"lahei",o)):t.navigateTo({url:"../home/home"});break;case"delete":i="/hole/note/remove",a={id:n},this.apiMethod(i,a,"delete",o);break;default:break}},apiMethod:function(e,n,o,i){var a=this;a.$http.post(e,n).then((function(e){200===e.data.code?("delete"===o&&a.mineList.splice(i,1),"lahei"===o&&(a.$u.toast("移至黑名单"),setTimeout((function(){a.tempList.splice(i,1)}),500))):501===e.data.code?setTimeout((function(){t.hideLoading(),a.$store.dispatch("Logout")}),800):a.$u.toast(e.data.message)})).catch((function(t){t.message;console.info("shenqinghaoyou:",t)})).finally((function(){}))},popupClose:function(){this.focus=!1},openPinglun:function(t){var e=this;this.letter=t,console.info("===============",t),this.placeholder="写评论",this.showKey=!0,setTimeout((function(){e.focus=!0}),300)},submit:function(){var e="/hole/note/comment",n={method:"note",note:this.letter.id,content:this.content},o=this;o.$http.post(e,n).then((function(e){var n=e.data;200===n.code?(o.getCommentList({note:o.letter.id,mine:1,page:1,size:9999}),o.showKey=!1):501===n.code?setTimeout((function(){t.hideLoading(),o.$store.dispatch("Logout")}),800):t.showToast({icon:"error",title:n.message,duration:3e3})})).catch((function(t){var e=t.message;o.$tip.error(e)})).finally((function(){}))},getCommentList:function(e){var n=this;n.$http.post("/hole/note/comment/list",e).then((function(e){var o=e.data;console.info("_result::",o),200===o.code?(n.commentList=o.data.list,n.letter.comment_num++):501===o.code&&setTimeout((function(){t.hideLoading(),n.$store.dispatch("Logout")}),800)})).catch((function(t){var e=t.message;n.$tip.error(e)})).finally((function(){}))}},onLoad:function(){this.height=this.height+this.statusBarHeight-1},onPullDownRefresh:function(){this.reloadData(),setTimeout((function(){t.stopPullDownRefresh()}),1e3)},onReachBottom:function(){var t=this;if(0===t.currIdx){if(0===t.ismore1)return t.$u.toast("没有更多了"),!1;t.page1+=1}else{if(0===t.ismore2)return t.$u.toast("没有更多了"),!1;t.page2+=1}var e={method:0===t.currIdx?"index":"mine",friend:"",page:0===t.currIdx?t.page1:t.page2,size:t.pageSize,last:0===t.currIdx?t.lastid1:t.lastid2};t.loadData(e)},onPageScroll:function(t){this.scrollTop=t.scrollTop},onShow:function(){},onShareAppMessage:function(t){return"button"===t.from&&console.log(t.target),{title:"树洞",path:"/pages/forest/forest"}}};e.default=c}).call(this,n("543d")["default"])},bb14:function(t,e,n){"use strict";n.r(e);var o=n("73de"),i=n.n(o);for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);e["default"]=i.a},f4a0:function(t,e,n){}},[["2928","common/runtime","common/vendor"]]]);